##!/bin/sh
#-------------------------------------------------------------------------------------# 
# PURPOSE: run file for Ix
#-------------------------------------------------------------------------------------# 
start=`date +%s`
#-------------------------------------------------------------------------------------# 
export DIR=~/data/ISD/ISD000/
if [ ! -d "$DIR" ]; then
    mkdir $DIR
fi

export -p IXDIR=/home/melodies-ist/wp07-di/src/main/app-resources/bin/ISD201_Vx/bin/

#-------------------------------------------------------------------------------------# 
function igcx(){
exec $IXDIR"vgt_to_geoms_002.sh" $1 $2 $3
}

#-------------------------------------------------------------------------------------# 
while IFS='' read -r line || [[ -n "$line" ]]; do
	if [[ "$line" == AOI1 ]] ; then	

		NI=$(grep "NIR001" $2)
		RE=$(grep "RED001" $2)
		LC=$(grep "LANDC001" $2)

		igcx $NI $LC $RE 
	
	elif [[ "$line" == AOI2 ]] ; then
		
		NI=$(grep "NIR001" $2)
		RE=$(grep "RED001" $2)
		LC=$(grep "LANDC001" $2)
		igcx $NI $LC $RE 

	elif [[ "$line" == AOI3 ]] ; then
		
		NI=$(grep "NIR001" $2)
		RE=$(grep "RED001" $2)
		LC=$(grep "LANDC001" $2)
		igcx $NI $LC $RE 

	elif [[ "$line" == AOI4 ]] ; then
		
		NI=$(grep "NIR001" $2)
		RE=$(grep "RED001" $2)
		LC=$(grep "LANDC001" $2)
		igcx $NI $LC $RE 
	else
		echo "AOI out of range"
	fi 
done < "$1"
#done < $inputfile
#-------------------------------------------------------------------------------------# 
end=`date +%s`
runtime=$((end-start))
echo "Runtime: $runtime seconds"
#-------------------------------------------------------------------------------------# 
exit 0 